<!DOCTYPE html>
<html lang="fr"><head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Soumission pour revêtement métallique MS1 Architectural - Application interactive.">
    <meta name="author" content="Groupe Perreault">
    <title>SOUMISSION MS1 #2 - Groupe Perreault</title>
    <style>
        /* Variables CSS */
        :root {
            --primary-color: #4b5563;
            --primary-light: #6b7280;
            --primary-dark: #374151;
            --primary-bg: #f9fafb;
            --danger-color: #ef4444;
            --danger-hover: #dc2626;
            --success-color: #6b7280;
            --success-hover: #4b5563;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            --transition-base: all 0.3s ease;
        }

        /* Reset et Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            font-size: 10px;
            line-height: 1.3;
            color: #333;
            background: #f5f5f5;
            min-height: 100vh;
        }

        /* Conteneur principal */
        .container {
            max-width: 8.5in;
            margin: 20px auto;
            background: white;
            box-shadow: var(--shadow-lg);
            padding: 0.4in;
            position: relative;
        }

        /* Barre de contrôle */
        .control-bar {
            position: sticky;
            top: 0;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-color) 100%);
            color: white;
            padding: 20px 15px;
            margin: -0.4in -0.4in 20px -0.4in;
            z-index: 1000;
            box-shadow: var(--shadow-md);
            text-align: center;
        }

        .control-bar h3 {
            margin-bottom: 15px;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            opacity: 0.95;
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }

        .control-btn {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            transition: var(--transition-base);
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            min-width: 140px;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .control-btn:active {
            transform: translateY(0) scale(1);
        }

        .control-btn.danger {
            background: rgba(239, 68, 68, 0.8);
            border-color: rgba(239, 68, 68, 0.5);
        }

        .control-btn.danger:hover {
            background: rgba(220, 38, 38, 0.9);
        }

        .control-btn.success {
            background: rgba(34, 197, 94, 0.9);
            border-color: rgba(34, 197, 94, 0.5);
        }

        .control-btn.success:hover {
            background: rgba(22, 163, 74, 1);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Paramètres */
        .settings-row {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.2);
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }

        .settings-row label {
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
        }

        .settings-row input[type="number"] {
            width: 60px;
            padding: 4px 8px;
            border: 1px solid rgba(255,255,255,0.4);
            border-radius: 3px;
            background: rgba(255,255,255,0.2);
            color: white;
            font-weight: 600;
        }

        .settings-row input[type="number"]:focus {
            outline: none;
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.6);
            box-shadow: 0 0 0 2px rgba(255,255,255,0.1);
        }

        /* Header */
        .header {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 15px;
        }

        .company-info {
            text-align: right;
            font-size: 10px;
            line-height: 1.2;
            color: #555;
        }

        .company-info input {
            transition: all 0.2s ease;
            text-align: right;
            color: #555;
            font-family: inherit;
            font-size: 10px;
        }

        .company-info input:hover:not(:focus) {
            background: rgba(75, 85, 99, 0.03) !important;
            cursor: pointer;
        }

        .company-info input:focus {
            background: rgba(255, 255, 255, 0.8) !important;
            border: 1px solid #e5e7eb !important;
            border-radius: 2px;
            padding: 1px 3px;
            outline: none;
            box-shadow: 0 0 0 2px rgba(75, 85, 99, 0.05);
        }

        .company-info input.inline {
            display: inline-block;
            margin: 0 2px;
        }

        .company-name {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 2px;
            color: var(--primary-dark);
        }

        .company-name input {
            color: var(--primary-dark);
            font-weight: bold;
            font-size: 12px;
            width: 100%;
            margin-bottom: 2px;
        }

        .company-info > div {
            margin-bottom: 1px;
        }

        .company-info > div:last-child {
            margin-bottom: 0;
        }

        /* Title */
        .title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin: 15px 0 8px 0;
            text-align: left;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary-color);
        }

        .subtitle {
            font-size: 11px;
            color: #666;
            margin-bottom: 15px;
            margin-top: 8px;
        }
        
        /* Project Info */
        .project-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-section {
            padding: 10px;
            background: #fafafa;
            border-radius: 4px;
            border: 1px solid #e5e7eb;
        }

        .info-section h4 {
            font-weight: bold;
            font-size: 10px;
            margin-bottom: 8px;
            color: var(--primary-dark);
            padding-bottom: 4px;
            border-bottom: 1px solid var(--primary-color);
        }

        .info-section p {
            font-size: 10px;
            line-height: 1.4;
            margin-bottom: 3px;
        }

        /* Tables */
        .table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
            margin-bottom: 10px;
            table-layout: fixed;
            background: white;
        }

        .table-header th {
            padding: 8px;
            text-align: left;
            font-weight: bold;
            font-size: 10px;
            border-right: 1px solid #777;
            vertical-align: middle;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-color) 100%);
            color: white;
        }

        .table-header th:nth-child(1) { width: 46%; text-align: left; }
        .table-header th:nth-child(2) { width: 10%; text-align: center; }
        .table-header th:nth-child(3) { width: 18%; text-align: right; }
        .table-header th:nth-child(4) { width: 18%; text-align: right; }
        .table-header th:nth-child(5) { width: 6%; text-align: center; border-right: none; }

        .table tbody tr:nth-child(even) { background: #f9fafb; }
        .table tbody tr:hover { background: #f3f4f6; }

        .table td {
            padding: 6px 8px;
            border-right: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
            font-size: 10px;
            vertical-align: top;
            word-wrap: break-word;
        }

        .table td:nth-child(1) { width: 46%; text-align: left; }
        .table td:nth-child(2) { width: 10%; text-align: center; }
        .table td:nth-child(3) { width: 18%; text-align: right; }
        .table td:nth-child(4) { width: 18%; text-align: right; font-weight: bold; }
        .table td:nth-child(5) { width: 6%; text-align: center; border-right: none; }

        .item-description { 
            font-weight: bold; 
            color: #333; 
            line-height: 1.3;
            position: relative;
        }
        
        .item-details { 
            font-size: 9px; 
            color: #666; 
            display: block; 
            margin-top: 3px; 
            font-style: italic; 
            line-height: 1.3; 
            font-weight: normal; 
        }

        /* Champs de description éditables */
        .item-title-input {
            font-weight: bold;
            color: #333;
            border: none;
            background: transparent;
            width: 100%;
            font-size: 10px;
            line-height: 1.3;
            padding: 2px;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .item-title-input:hover {
            background: rgba(75, 85, 99, 0.03);
            cursor: pointer;
        }

        .item-title-input:focus {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 2px;
            outline: none;
            box-shadow: 0 0 0 2px rgba(75, 85, 99, 0.05);
        }

        .item-details-input {
            font-size: 9px;
            color: #666;
            border: none;
            background: transparent;
            width: 100%;
            line-height: 1.3;
            font-style: italic;
            font-weight: normal;
            padding: 2px;
            margin-top: 3px;
            transition: all 0.2s ease;
            font-family: inherit;
            resize: vertical;
            min-height: 30px;
        }

        .item-details-input:hover {
            background: rgba(75, 85, 99, 0.03);
            cursor: pointer;
        }

        .item-details-input:focus {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 2px;
            outline: none;
            box-shadow: 0 0 0 2px rgba(75, 85, 99, 0.05);
            font-style: normal;
        }
        
        .category-header-row td { 
            background: #f9fafb; 
            font-weight: bold; 
            padding: 6px 8px !important; 
            color: var(--primary-dark); 
            font-size: 11px;
        }
        
        /* Titres de catégories éditables */
        .category-title-input {
            font-weight: bold;
            color: var(--primary-dark);
            font-size: 11px;
            border: none;
            background: transparent;
            width: 100%;
            padding: 2px;
            transition: all 0.2s ease;
            font-family: inherit;
        }
        
        .category-title-input:hover {
            background: rgba(75, 85, 99, 0.03);
            cursor: pointer;
        }
        
        .category-title-input:focus {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 2px;
            outline: none;
            box-shadow: 0 0 0 2px rgba(75, 85, 99, 0.05);
        }
        
        .subtotal-row td { 
            background: #f3f4f6 !important; 
            font-weight: bold !important; 
            padding: 6px 8px !important; 
        }
        
        .total-row td { 
            background: var(--primary-bg) !important; 
            font-weight: bold !important; 
            font-size: 11px !important; 
            border-top: 2px solid var(--primary-color); 
        }

        /* Inputs */
        .amount-input {
            width: 100%;
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 10px;
            text-align: right;
            font-family: 'Courier New', monospace;
            transition: var(--transition-base);
        }

        .amount-input:focus {
            outline: none;
            border-color: var(--primary-color);
            background: var(--primary-bg);
            box-shadow: 0 0 0 2px rgba(5, 150, 105, 0.1);
        }

        .amount-input.error {
            border-color: var(--danger-color);
            background: #fef2f2;
        }

        .quantity-input {
            width: 100%;
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 10px;
            text-align: center;
            font-family: 'Courier New', monospace;
            transition: var(--transition-base);
        }

        .quantity-input:focus {
            outline: none;
            border-color: var(--primary-color);
            background: var(--primary-bg);
            box-shadow: 0 0 0 2px rgba(5, 150, 105, 0.1);
        }

        .quantity-input.error {
            border-color: var(--danger-color);
            background: #fef2f2;
        }

        /* Header inputs */
        .header-input {
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 3px 8px;
            font-size: 11px;
            background: #f9f9f9;
            transition: var(--transition-base);
        }

        .header-input:focus {
            outline: none;
            border-color: var(--primary-color);
            background: white;
            box-shadow: 0 0 0 2px rgba(5, 150, 105, 0.1);
        }

        .date-input {
            width: 140px;
        }

        /* Info inputs */
        .info-input {
            border: 1px solid #e5e7eb;
            border-radius: 3px;
            padding: 4px 8px;
            font-size: 10px;
            background: white;
            transition: var(--transition-base);
            width: 100%;
            font-family: inherit;
            min-width: 40px;
        }

        .info-input:focus {
            outline: none;
            border-color: var(--primary-color);
            background: white;
            box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.1);
        }

        .info-input.inline {
            display: inline;
            width: auto;
        }

        .info-input::placeholder {
            color: #9ca3af;
            font-style: italic;
            font-size: 9px;
        }

        strong .info-input {
            font-weight: 600;
        }

        /* Styles spéciaux pour les champs de contact */
        .info-section input {
            transition: all 0.2s ease;
        }

        .info-section input:hover:not(:focus) {
            background: rgba(75, 85, 99, 0.03) !important;
            cursor: pointer;
        }

        .info-section input:focus {
            background: rgba(255, 255, 255, 0.9) !important;
            border: 1px solid #e5e7eb !important;
            border-radius: 2px;
            padding: 2px 4px;
            outline: none;
            box-shadow: 0 0 0 2px rgba(75, 85, 99, 0.05);
        }

        .amount-display {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #111;
        }

        /* Checkbox pour masquer */
        .hide-checkbox {
            cursor: pointer;
            transform: scale(1.2);
            accent-color: var(--primary-color);
        }


        /* Section cachée */
        .section-row.hidden {
            display: none;
        }

        /* Section entière cachée */
        .section.hidden-section {
            display: none !important;
        }

        /* Sections */
        .section {
            margin-bottom: 15px;
            transition: opacity 0.3s;
            border-radius: 4px;
            overflow: hidden;
        }

        .section.hidden-section {
            display: none;
        }

        /* Récapitulatif */
        .summary-box {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f9fafb 0%, #e5e7eb 100%);
            border-radius: 6px;
            border-left: 4px solid var(--primary-color);
            box-shadow: var(--shadow-sm);
        }

        .summary-box h4 {
            margin-bottom: 15px;
            font-size: 13px;
            color: var(--primary-dark);
            font-weight: 600;
        }

        .summary-table {
            width: 100%;
            font-size: 11px;
        }

        .summary-table td {
            padding: 6px 10px;
        }

        .summary-table .label {
            text-align: right;
            padding-right: 20px;
            color: #555;
        }

        .summary-table .value {
            text-align: right;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            width: 150px;
            color: #111;
        }

        .summary-table .total-row {
            border-top: 2px solid var(--primary-color);
            font-size: 14px;
            background: white;
        }

        /* Tableau comparatif */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            margin-bottom: 30px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 10px;
            border: 1px solid #ddd;
            font-size: 10px;
        }

        .comparison-table th {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-color) 100%);
            color: white;
            font-weight: bold;
            text-align: center;
        }

        .comparison-table th:first-child {
            text-align: left;
        }

        .comparison-table td:first-child {
            font-weight: bold;
            background: #f9fafb;
        }

        .comparison-table tr:hover {
            background: #f3f4f6;
        }

        .comparison-table .highlight {
            background: #fef3c7;
            font-weight: bold;
        }

        /* Notes and exclusions */
        .exclusions, .conditions {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #fafafa 0%, #f9fafb 100%);
            border: 1px solid #e5e7eb;
            border-left: 4px solid var(--primary-color);
            border-radius: 4px;
        }

        .exclusions h4, .conditions h4 { 
            font-weight: bold; 
            margin-bottom: 10px; 
            color: var(--primary-dark); 
            font-size: 11px; 
        }
        
        .exclusions ul, .conditions ul { 
            margin-left: 15px; 
        }
        
        .exclusions li, .conditions li { 
            margin-bottom: 4px; 
            font-size: 9px; 
            line-height: 1.4; 
            color: #555;
            display: list-item;
            list-style-type: disc;
            list-style-position: outside;
        }
        
        .exclusions li {
            padding-left: 2px;
        }
        
        .conditions li {
            display: list-item;
            list-style-type: disc;
            list-style-position: outside;
            padding-left: 2px;
        }
        
        /* Champs éditables pour conditions et exclusions */
        .condition-input, .exclusion-input {
            border: none;
            background: transparent;
            width: 100%;
            font-size: 9px;
            line-height: 1.4;
            color: #555;
            padding: 2px 0;
            margin: 0;
            transition: all 0.2s ease;
            font-family: inherit;
            resize: vertical;
            min-height: 18px;
            display: inline-block;
            vertical-align: top;
        }
        
        .condition-input:hover, .exclusion-input:hover {
            background: rgba(75, 85, 99, 0.03);
            cursor: pointer;
        }
        
        .condition-input:focus, .exclusion-input:focus {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 2px;
            outline: none;
            box-shadow: 0 0 0 2px rgba(75, 85, 99, 0.05);
            padding: 2px 4px;
            margin: -2px -4px;
            width: calc(100% + 8px);
        }
        
        .condition-label {
            font-weight: bold;
            color: #333;
            margin-right: 5px;
        }

        /* Section Pièces jointes */
        .attachments-section {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #0284c7;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .attachments-section h4 {
            font-size: 14px;
            color: #0c4a6e;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .attachment-dropzone {
            border: 2px dashed #0284c7;
            border-radius: 6px;
            padding: 30px;
            text-align: center;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }
        
        .attachment-dropzone:hover {
            background: #f0f9ff;
            border-color: #0369a1;
        }
        
        .attachment-dropzone.dragover {
            background: #dbeafe;
            border-color: #0369a1;
            transform: scale(1.02);
        }
        
        .dropzone-text {
            font-size: 12px;
            color: #64748b;
            margin-bottom: 10px;
        }
        
        .dropzone-icon {
            font-size: 48px;
            color: #0284c7;
            margin-bottom: 10px;
        }
        
        .file-input-label {
            display: inline-block;
            padding: 8px 20px;
            background: #0284c7;
            color: white;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .file-input-label:hover {
            background: #0369a1;
            transform: translateY(-1px);
        }
        
        #fileInput {
            display: none;
        }
        
        .attachments-list {
            display: grid;
            gap: 10px;
            margin-top: 15px;
        }
        
        .attachment-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .attachment-item:hover {
            background: #f9fafb;
            border-color: #0284c7;
            transform: translateX(5px);
        }
        
        .attachment-icon {
            font-size: 24px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        
        .attachment-info {
            flex: 1;
            min-width: 0;
        }
        
        .attachment-name {
            font-size: 11px;
            font-weight: 600;
            color: #1e293b;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .attachment-size {
            font-size: 9px;
            color: #64748b;
        }
        
        .attachment-actions {
            display: flex;
            gap: 8px;
        }
        
        .attachment-btn {
            padding: 5px 10px;
            font-size: 10px;
            border: 1px solid #e5e7eb;
            border-radius: 3px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .attachment-btn:hover {
            background: #f9fafb;
            border-color: #0284c7;
        }
        
        .attachment-btn.view {
            color: #0284c7;
            border-color: #0284c7;
        }
        
        .attachment-btn.view:hover {
            background: #0284c7;
            color: white;
        }
        
        .attachment-btn.remove {
            color: #ef4444;
            border-color: #ef4444;
        }
        
        .attachment-btn.remove:hover {
            background: #ef4444;
            color: white;
        }
        
        .file-preview-modal {
            display: none;
            position: fixed;
            z-index: 4000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
        }
        
        .file-preview-modal.show {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .preview-content {
            max-width: 90%;
            max-height: 90%;
            background: white;
            border-radius: 8px;
            overflow: auto;
            position: relative;
        }
        
        .preview-close {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            z-index: 1;
        }
        
        .preview-close:hover {
            background: rgba(0, 0, 0, 0.8);
        }
        
        .preview-image {
            max-width: 100%;
            max-height: 100%;
            display: block;
        }
        
        .preview-text {
            padding: 20px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .supported-formats {
            font-size: 9px;
            color: #64748b;
            margin-top: 5px;
            text-align: center;
        }

        /* Section Signature */
        .signature-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #0284c7;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .signature-section h4 {
            font-size: 14px;
            color: #0c4a6e;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .decision-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .decision-btn {
            padding: 15px 40px;
            font-size: 14px;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 200px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .btn-accept {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .btn-accept:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(16, 185, 129, 0.3);
        }

        .btn-refuse {
            background: linear-gradient(135deg, #f87171 0%, #ef4444 100%);
            color: white;
        }

        .btn-refuse:hover {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(239, 68, 68, 0.3);
        }

        .signature-form {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }

        .signature-form.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 10px;
            font-weight: 600;
            margin-bottom: 5px;
            color: #374151;
        }

        .form-group input,
        .form-group textarea {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 11px;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #0284c7;
            box-shadow: 0 0 0 3px rgba(2, 132, 199, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .confirmation-message {
            display: none;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            text-align: center;
            font-weight: 600;
            font-size: 12px;
        }

        .confirmation-message.accepted {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #6ee7b7;
        }

        .confirmation-message.refused {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }

        .confirm-action-btn {
            margin-top: 15px;
            padding: 10px 30px;
            background: #0284c7;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .confirm-action-btn:hover {
            background: #0369a1;
            transform: translateY(-1px);
        }

        .signature-timestamp {
            margin-top: 10px;
            font-size: 9px;
            color: #6b7280;
            text-align: center;
            font-style: italic;
        }

        .signature-section.signed .decision-buttons {
            display: none;
        }

        .signature-section.signed .signature-form {
            display: none !important;
        }

        /* Footer */
        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 9px;
            color: #666;
            border-top: 2px solid var(--primary-color);
            padding-top: 15px;
        }

        .footer input {
            transition: all 0.2s ease;
            font-family: inherit;
            font-size: inherit;
            color: inherit;
        }

        .footer input:hover:not(:focus) {
            background: rgba(102, 102, 102, 0.03) !important;
            cursor: pointer;
        }

        .footer input:focus {
            background: rgba(255, 255, 255, 0.8) !important;
            border: 1px solid #e5e7eb !important;
            border-radius: 2px;
            padding: 1px 3px;
            outline: none;
            box-shadow: 0 0 0 2px rgba(102, 102, 102, 0.05);
        }
        
        .page-number { 
            text-align: right; 
            margin-top: 20px; 
            padding-top: 10px; 
            font-size: 9px; 
            color: #999; 
            border-top: 1px solid #ddd;
        }

        /* Indicateur de sauvegarde */
        .save-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            background: var(--success-color);
            color: white;
            border-radius: 6px;
            box-shadow: var(--shadow-lg);
            display: none;
            z-index: 1001;
            font-weight: 600;
            font-size: 12px;
        }

        .save-indicator.show {
            display: block;
            animation: fadeInOut 2s ease;
        }

        .save-indicator.error {
            background: var(--danger-color);
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(20px); }
            20% { opacity: 1; transform: translateY(0); }
            80% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(20px); }
        }

        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Modal pour liste des sauvegardes */
        .modal {
            display: none;
            position: fixed;
            z-index: 3000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s;
        }

        .modal.show {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            max-width: 600px;
            width: 90%;
            max-height: 70vh;
            overflow-y: auto;
            animation: slideIn 0.3s;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
        }

        .modal-header h3 {
            margin: 0;
            color: var(--primary-dark);
            font-size: 18px;
        }

        .modal-close {
            cursor: pointer;
            font-size: 24px;
            color: #999;
            background: none;
            border: none;
            padding: 0;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: var(--danger-color);
        }

        .saved-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .saved-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .saved-item:hover {
            background: #f3f4f6;
            border-color: var(--primary-color);
            transform: translateX(5px);
        }

        .saved-item-info {
            flex: 1;
        }

        .saved-item-number {
            font-weight: bold;
            color: var(--primary-dark);
            font-size: 12px;
        }

        .saved-item-details {
            font-size: 10px;
            color: #666;
            margin-top: 3px;
        }

        .saved-item-actions {
            display: flex;
            gap: 8px;
        }

        .saved-item-btn {
            padding: 5px 10px;
            font-size: 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
            cursor: pointer;
            background: white;
            transition: all 0.3s;
        }

        .saved-item-btn.load {
            color: var(--primary-dark);
            border-color: var(--primary-color);
        }

        .saved-item-btn.load:hover {
            background: var(--primary-color);
            color: white;
        }

        .saved-item-btn.delete {
            color: var(--danger-color);
            border-color: var(--danger-color);
        }

        .saved-item-btn.delete:hover {
            background: var(--danger-color);
            color: white;
        }

        .no-saves {
            text-align: center;
            padding: 40px;
            color: #999;
            font-style: italic;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { 
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 4px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 11px;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Mode impression */
        @media print {
            body {
                background: white;
                font-size: 9px;
            }
            
            .control-bar {
                display: none !important;
            }
            
            .loading-overlay {
                display: none !important;
            }
            
            .save-indicator {
                display: none !important;
            }
            
            .container {
                box-shadow: none;
                margin: 0;
                padding: 0.3in;
                max-width: 100%;
            }
            
            .hide-checkbox {
                display: none !important;
            }
            
            .amount-input, .quantity-input, .header-input, .info-input,
            .item-title-input, .item-details-input, .condition-input, .exclusion-input,
            .category-title-input {
                border: none !important;
                background: transparent !important;
                padding: 0 !important;
                box-shadow: none !important;
            }
            
            .item-title-input {
                font-weight: bold !important;
                color: #333 !important;
            }
            
            .item-details-input {
                font-size: 9px !important;
                color: #666 !important;
                font-style: italic !important;
                height: auto !important;
            }
            
            .condition-input, .exclusion-input {
                font-size: 9px !important;
                color: #555 !important;
                height: auto !important;
                line-height: 1.4 !important;
            }
            
            .condition-label {
                font-weight: bold !important;
                color: #333 !important;
            }
            
            .category-title-input {
                font-weight: bold !important;
                color: var(--primary-dark) !important;
                font-size: 11px !important;
            }
            
            .table-header th:nth-child(5),
            .table td:nth-child(5) {
                display: none !important;
            }
            
            .signature-section:not(.signed) {
                display: none !important;
            }
            
            .decision-buttons {
                display: none !important;
            }
            
            .signature-form {
                display: none !important;
            }
            
            .attachments-section {
                display: none !important;
            }
            
            .file-preview-modal {
                display: none !important;
            }
            
            .table-header th:nth-child(1) { width: 52% !important; }
            .table td:nth-child(1) { width: 52% !important; }
            
            .table-header th {
                background: var(--primary-dark) !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                color-adjust: exact;
            }
            
            .category-header-row td,
            .subtotal-row td,
            .total-row td,
            .summary-box {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                color-adjust: exact;
            }
            
            .section {
                page-break-inside: avoid;
            }
            
            .summary-box {
                page-break-inside: avoid;
            }
        }

        /* Responsive - Tablettes */
        @media screen and (max-width: 1024px) {
            .container {
                margin: 15px;
                padding: 0.3in;
            }
            
            .control-buttons {
                grid-template-columns: repeat(2, 1fr);
                display: grid;
                gap: 8px;
            }
            
            .table {
                font-size: 9px;
            }
            
            .company-info {
                font-size: 9px;
            }
        }
        
        /* Responsive - Mobile */
        @media screen and (max-width: 768px) {
            body {
                font-size: 12px;
            }
            
            .container {
                margin: 0;
                padding: 15px;
                box-shadow: none;
                border-radius: 0;
            }
            
            /* Barre de contrôle mobile */
            .control-bar {
                margin: -15px -15px 15px -15px;
                padding: 15px 10px;
                position: relative;
            }
            
            .control-bar h3 {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .control-buttons {
                display: grid;
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .control-btn {
                width: 100%;
                padding: 12px 10px;
                font-size: 12px;
                min-width: auto;
                min-height: 44px; /* Taille minimale tactile recommandée */
            }
            
            .settings-row {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
                margin-top: 15px;
            }
            
            .settings-row label {
                display: flex;
                justify-content: space-between;
                align-items: center;
                font-size: 12px;
            }
            
            .settings-row input[type="number"] {
                width: 80px;
                padding: 6px 10px;
                font-size: 14px;
            }
            
            /* Header mobile */
            .header {
                flex-direction: column;
                align-items: flex-start;
                padding-bottom: 10px;
            }
            
            .company-info {
                width: 100%;
                text-align: left;
                font-size: 11px;
                margin-top: 10px;
            }
            
            .company-name {
                font-size: 14px;
            }
            
            /* Titre et sous-titre */
            .title {
                font-size: 20px;
                margin: 10px 0;
                padding-bottom: 5px;
            }
            
            .subtitle {
                font-size: 12px;
                flex-wrap: wrap;
            }
            
            /* Info projet mobile */
            .project-info {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .info-section {
                padding: 12px;
            }
            
            .info-section h4 {
                font-size: 12px;
                margin-bottom: 10px;
            }
            
            .info-section p {
                font-size: 11px;
                line-height: 1.5;
            }
            
            .info-input {
                font-size: 11px;
                padding: 6px 8px;
                min-height: 36px;
            }
            
            /* Tables mobile - Scroll horizontal */
            .section {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                margin: 0 -15px;
                padding: 0 15px;
            }
            
            .table {
                min-width: 600px;
                font-size: 10px;
            }
            
            .table-header th {
                padding: 10px 6px;
                font-size: 11px;
            }
            
            .table td {
                padding: 8px 6px;
                font-size: 10px;
            }
            
            .amount-input,
            .quantity-input {
                font-size: 11px;
                padding: 6px 4px;
                min-height: 36px;
            }
            
            .item-title-input,
            .item-details-input {
                font-size: 11px;
                padding: 4px;
                min-height: 32px;
            }
            
            .item-details-input {
                min-height: 50px;
            }
            
            .category-header-row td {
                font-size: 12px;
                padding: 10px 6px !important;
            }
            
            .category-title-input {
                font-size: 12px;
                padding: 4px;
            }
            
            /* Indicateur de scroll */
            .section::after {
                content: "→ Glissez pour voir plus →";
                display: block;
                text-align: center;
                color: #999;
                font-size: 10px;
                padding: 5px;
                margin-top: 5px;
            }
            
            .section::-webkit-scrollbar {
                height: 6px;
            }
            
            .section::-webkit-scrollbar-track {
                background: #f1f1f1;
                border-radius: 3px;
            }
            
            .section::-webkit-scrollbar-thumb {
                background: var(--primary-color);
                border-radius: 3px;
            }
            
            /* Summary box mobile */
            .summary-box {
                padding: 15px;
                margin: 20px 0;
            }
            
            .summary-box h4 {
                font-size: 14px;
                margin-bottom: 12px;
            }
            
            .summary-table {
                font-size: 12px;
            }
            
            .summary-table td {
                padding: 8px 5px;
            }
            
            .summary-table .value {
                width: 100px;
                font-size: 12px;
            }
            
            .summary-table .total-row {
                font-size: 15px;
            }
            
            /* Conditions et Exclusions mobile */
            .conditions,
            .exclusions {
                padding: 12px;
                margin-top: 15px;
            }
            
            .conditions h4,
            .exclusions h4 {
                font-size: 13px;
                margin-bottom: 12px;
            }
            
            .conditions ul,
            .exclusions ul {
                margin-left: 10px;
            }
            
            .conditions li,
            .exclusions li {
                margin-bottom: 8px;
                font-size: 11px;
                line-height: 1.5;
            }
            
            .condition-input,
            .exclusion-input {
                font-size: 11px;
                padding: 2px 0;
                min-height: 36px;
            }
            
            .exclusions li,
            .conditions li {
                padding-left: 4px;
            }
            
            /* Section signature mobile */
            .signature-section {
                padding: 20px;
                margin-top: 20px;
            }
            
            .signature-section h4 {
                font-size: 15px;
                margin-bottom: 15px;
            }
            
            .decision-buttons {
                flex-direction: column;
                gap: 12px;
            }
            
            .decision-btn {
                width: 100%;
                padding: 15px 20px;
                font-size: 13px;
                min-height: 50px;
            }
            
            .signature-form {
                padding: 15px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .form-group input,
            .form-group textarea {
                font-size: 12px;
                padding: 10px;
                min-height: 44px;
            }
            
            /* Footer mobile */
            .footer {
                font-size: 10px;
                padding-top: 12px;
                margin-top: 20px;
            }
            
            /* Modal mobile */
            .modal-content {
                width: 95%;
                max-height: 85vh;
                padding: 20px;
            }
            
            .modal-header h3 {
                font-size: 16px;
            }
            
            .saved-item {
                padding: 10px;
                margin-bottom: 6px;
            }
            
            .saved-item-number {
                font-size: 11px;
            }
            
            .saved-item-details {
                font-size: 9px;
            }
            
            .saved-item-btn {
                padding: 6px 10px;
                font-size: 9px;
            }
            
            /* Save indicator mobile */
            .save-indicator {
                bottom: 10px;
                right: 10px;
                padding: 10px 15px;
                font-size: 11px;
            }
            
            /* Amélioration de la lisibilité */
            input:focus,
            textarea:focus,
            select:focus {
                font-size: 16px !important; /* Empêche le zoom automatique sur iOS */
            }

            /* Tableau comparatif mobile */
            .comparison-table {
                font-size: 9px;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 6px;
            }
        }
        
        /* Très petits écrans */
        @media screen and (max-width: 375px) {
            .container {
                padding: 10px;
            }
            
            .control-bar {
                padding: 12px 8px;
            }
            
            .control-btn {
                font-size: 11px;
                padding: 10px 8px;
            }
            
            .title {
                font-size: 18px;
            }
            
            .table {
                min-width: 550px;
            }
            
            .summary-table .value {
                width: 80px;
            }
        }
        
        /* Mode paysage mobile */
        @media screen and (max-width: 812px) and (orientation: landscape) {
            .control-bar {
                padding: 10px;
            }
            
            .control-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .control-btn {
                padding: 8px 10px;
                font-size: 11px;
                min-height: 38px;
            }
            
            .settings-row {
                flex-direction: row;
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Barre de contrôle -->
    <div class="control-bar" id="controlBar">
        <h3>🛠️ Contrôles de la soumission</h3>
        <div class="control-buttons">
            <button class="control-btn success" onclick="APP.calculateAll()" title="Recalculer tous les montants">
                💰 Recalculer tout
            </button>
            <button class="control-btn" onclick="APP.toggleAllSections()" title="Afficher ou masquer toutes les sections">
                👁️ Afficher/Masquer tout
            </button>
            <button class="control-btn" onclick="APP.toggleEmptySections()" title="Masquer automatiquement les sections sans prix">🔍 Masquer sections vides</button>
            <button class="control-btn" onclick="APP.saveData()" title="Sauvegarder dans le navigateur">
                💾 Sauvegarder
            </button>
            <button class="control-btn success" onclick="APP.saveAs()" title="Enregistrer sous un nouveau numéro">
                💾 Enregistrer sous
            </button>
            <button class="control-btn" onclick="APP.showSavedList()" title="Voir et charger les soumissions sauvegardées">
                📂 Charger
            </button>
            <button class="control-btn danger" onclick="APP.resetAll()" title="Réinitialiser tous les champs">
                🔄 Réinitialiser
            </button>
            <button class="control-btn" onclick="APP.clearCache()" title="Vider le cache du navigateur" style="background: rgba(239, 68, 68, 0.6);">
                🗑️ Vider Cache
            </button>
            <button class="control-btn" onclick="APP.resetTexts()" title="Réinitialiser tous les textes à leurs valeurs par défaut">
                📝 Réinitialiser Textes
            </button>
            <button class="control-btn" onclick="window.print()" title="Imprimer ou enregistrer en PDF">
                🖨️ Imprimer
            </button>
            <button class="control-btn" onclick="APP.exportData()" title="Exporter les données au format JSON">
                ⬇️ Exporter JSON
            </button>
            <button class="control-btn" onclick="APP.exportHTML()" title="Télécharger une copie HTML complète">
                📄 Télécharger HTML
            </button>
            <button class="control-btn" onclick="APP.importData()" title="Importer des données depuis un fichier JSON">
                ⬆️ Importer
            </button>
        </div>
        <div class="settings-row">
            <label>
                💼 Admin: <input type="number" id="adminRate" value="0" min="0" max="10" step="0.5" onchange="APP.updateAdminRate()">%
                <span id="adminPercent" style="display:none;">0</span>
            </label>
            <label>
                ⚠️ Contingences: <input type="number" id="contingencyRate" value="0" min="0" max="25" step="0.5" onchange="APP.updateContingencyRate()">%
                <span id="contingencyPercent" style="display:none;">0</span>
            </label>
            <label>
                💰 Profit: <input type="number" id="profitRate" value="15" min="0" max="50" step="0.5" onchange="APP.updateProfitRate()">%
                <span id="profitPercent" style="display:none;">15</span>
            </label>
        </div>
    </div>

    <!-- Conteneur principal -->
    <div class="container">
        <!-- Header avec logo et informations de l'entreprise -->
        <div class="header">
            <div class="company-info">
                <div class="company-name">
                    <input type="text" id="nomEntreprise" value="Groupe Perreault" style="border: none; background: transparent;" placeholder="Nom de l'entreprise" onchange="APP.syncCompanyName(event); APP.autoSave()">
                </div>
                <div><input type="text" id="adresseEntreprise" value="123, rue Principale" style="border: none; background: transparent; width: 100%;" placeholder="Adresse" onchange="APP.autoSave()"></div>
                <div>
                    <input type="text" id="villeEntreprise" value="Montréal (Québec)" style="border: none; background: transparent; width: 70%; display: inline;" placeholder="Ville, Province" onchange="APP.autoSave()">
                    <input type="text" id="codePostalEntreprise" value="H1A 1A1" style="border: none; background: transparent; width: 28%; display: inline;" placeholder="Code postal" onchange="APP.autoSave()">
                </div>
                <div>
                    <span>Tél: </span>
                    <input type="text" id="telEntreprise" value="(514) 555-0000" style="border: none; background: transparent; width: 100px; display: inline;" placeholder="Téléphone" onchange="APP.autoSave()">
                    <span> | Cell: </span>
                    <input type="text" id="cellEntreprise" value="(514) 555-1111" style="border: none; background: transparent; width: 100px; display: inline;" placeholder="Cellulaire" onchange="APP.autoSave()">
                </div>
                <div>
                    <input type="text" id="emailEntreprise" value="info@groupeperreault.com" style="border: none; background: transparent; width: 100%;" placeholder="Courriel" onchange="APP.autoSave()">
                </div>
                <div style="font-size: 9px; margin-top: 3px;">
                    <span>RBQ: </span>
                    <input type="text" id="rbqEntreprise" value="1234-5678-90" style="border: none; background: transparent; width: 80px; font-size: 9px; display: inline;" placeholder="# RBQ" onchange="APP.autoSave()">
                    <span> | NEQ: </span>
                    <input type="text" id="neqEntreprise" value="1234567890" style="border: none; background: transparent; width: 80px; font-size: 9px; display: inline;" placeholder="# NEQ" onchange="APP.autoSave()">
                </div>
                <div style="font-size: 9px;">
                    <span>TPS: </span>
                    <input type="text" id="tpsEntreprise" value="123456789RT0001" style="border: none; background: transparent; width: 110px; font-size: 9px; display: inline;" placeholder="# TPS" onchange="APP.updateTaxNumbers(); APP.autoSave()">
                </div>
                <div style="font-size: 9px;">
                    <span>TVQ: </span>
                    <input type="text" id="tvqEntreprise" value="1234567890TQ0001" style="border: none; background: transparent; width: 110px; font-size: 9px; display: inline;" placeholder="# TVQ" onchange="APP.updateTaxNumbers(); APP.autoSave()">
                </div>
            </div>
        </div>

        <!-- Titre -->
        <h1 class="title">SOUMISSION #2 - REVÊTEMENT MS1 ARCHITECTURAL</h1>
        <div class="subtitle">
            <span style="margin-right: 20px;"><strong>N° de soumission:</strong> 
                <input type="text" id="numeroSoumission" class="header-input" value="MS1-002" style="width: 120px;" placeholder="Numéro" onchange="APP.autoSave()">
            </span>
            <span><strong>Date:</strong> 
                <input type="date" id="dateSoumission" class="header-input date-input" value="2025-08-22" onchange="APP.autoSave()">
            </span>
        </div>

        <!-- Informations du projet -->
        <div class="project-info">
            <div class="info-section">
                <h4>Client</h4>
                <p><strong>Adresse: </strong><input type="text" id="adresseClient" class="info-input inline" placeholder="Adresse complète" value="430, chemin de la Presqu'île" onchange="APP.autoSave()"></p>
                <p><strong>Ville: </strong><input type="text" id="villeClient" class="info-input inline" placeholder="Ville" style="width: 70%;" value="Repentigny" onchange="APP.autoSave()"></p>
                <p><strong>Code postal: </strong><input type="text" id="codePostalClient" class="info-input inline" placeholder="H0H 0H0" style="width: 60px;" value="J6A 7J4" onchange="APP.autoSave()"></p>
            </div>
            <div class="info-section">
                <h4>Projet</h4>
                <p><strong>Description: </strong><input type="text" id="nomProjet" class="info-input inline" placeholder="Description du projet" value="Revêtement MS1 ARCHITECTURAL" onchange="APP.autoSave()"></p>
                <p><strong>Type: </strong><input type="text" id="typeConstruction" class="info-input inline" placeholder="Type de projet" value="Maison bi-générationnelle" onchange="APP.autoSave()"></p>
                <p><strong>Superficie: </strong><input type="text" id="superficie" class="info-input inline" placeholder="0 pi²" style="width: 80px;" value="3,844 pi²" onchange="APP.autoSave()"></p>
                <p><strong>Matériau: </strong><input type="text" id="typeFondation" class="info-input inline" placeholder="Type" style="width: 120px;" value="Acier galvanisé" onchange="APP.autoSave()"></p>
            </div>
            <div class="info-section">
                <h4>Contact</h4>
                <p><strong>Nom: </strong><input type="text" id="nomContact" class="info-input inline" placeholder="Nom du contact" onchange="APP.autoSave()"></p>
                <p><strong>Tél: </strong><input type="text" id="telContact" class="info-input inline" placeholder="(514) 000-0000" style="width: 90px;" onchange="APP.autoSave()"></p>
                <p><strong>Cell: </strong><input type="text" id="cellContact" class="info-input inline" placeholder="(514) 000-0000" style="width: 90px;" onchange="APP.autoSave()"></p>
                <p><strong>Courriel: </strong><input type="email" id="emailContact" class="info-input inline" placeholder="email@exemple.com" onchange="APP.autoSave()"></p>
            </div>
            <div class="info-section">
                <h4>Responsables</h4>
                <p><strong>Chargé de projet: </strong><input type="text" id="chargeProjet" class="info-input inline" placeholder="Nom du chargé de projet" onchange="APP.autoSave()"></p>
                <p><strong>Préparé par: </strong><input type="text" id="preparePar" class="info-input inline" placeholder="Nom du préparateur" onchange="APP.autoSave()"></p>
            </div>
        </div>

        <!-- Section A - Matériaux Système MS1 -->
        <div class="section" data-section="A">
            <table class="table">
                <thead class="table-header">
                    <tr>
                        <th>Item</th>
                        <th>Quantité</th>
                        <th>Coût unitaire</th>
                        <th>Coût total</th>
                        <th title="Afficher/Masquer les items">☑</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header-row">
                        <td colspan="5"><input type="text" class="category-title-input" id="category-A" value="A - MATÉRIAUX - SYSTÈME MS1" placeholder="Titre de la catégorie" onchange="APP.updateRecapLabels(); APP.autoSave()"></td>
                    </tr>
                    <tr class="section-row" data-item="A-1">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-1" value="REVÊTEMENT PRINCIPAL - Panneaux MS1 12 pouces acier prépeint" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-1" placeholder="Description détaillée" onchange="APP.autoSave()">Panneaux métalliques architecturaux calibre 24, choix de 35 couleurs</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-1" value="4228" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-1" value="11.50" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-1">48 622,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="A-2">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-2" value="Coins extérieurs MS1" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-2" placeholder="Description détaillée" onchange="APP.autoSave()">Profilés de coin extérieur métalliques</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-2" value="200" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-2" value="28" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-2">5 600,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="A-3">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-3" value="Coins intérieurs MS1" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-3" placeholder="Description détaillée" onchange="APP.autoSave()">Profilés de coin intérieur métalliques</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-3" value="120" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-3" value="24" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-3">2 880,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="A-4">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-4" value="Moulures en J métalliques" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-4" placeholder="Description détaillée" onchange="APP.autoSave()">Pour contours de fenêtres et portes</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-4" value="500" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-4" value="18" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-4">9 000,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="A-5">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-5" value="Moulures de départ MS1" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-5" placeholder="Description détaillée" onchange="APP.autoSave()">Profilé de départ pour base du revêtement</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-5" value="180" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-5" value="20" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-5">3 600,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="A-6">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-6" value="Solins architecturaux" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-6" placeholder="Description détaillée" onchange="APP.autoSave()">Solins métalliques pour étanchéité</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-6" value="300" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-6" value="25" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-6">7 500,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="A-7">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-7" value="Rails ventilation continue" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-7" placeholder="Description détaillée" onchange="APP.autoSave()">Système de ventilation intégré</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-7" value="180" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-7" value="15" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-7">2 700,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="A-8">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-8" value="Grilles perforées MS1" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-8" placeholder="Description détaillée" onchange="APP.autoSave()">Grilles de ventilation architecturales</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-8" value="20" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-8" value="45" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-8">900,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="A-9">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-9" value="Soffites MS1 perforés" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-9" placeholder="Description détaillée" onchange="APP.autoSave()">Soffites métalliques ventilés</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-9" value="280" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-9" value="12" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-9">3 360,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="A-10">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="A-10" value="Fascias MS1 coordonnés" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="A-10" placeholder="Description détaillée" onchange="APP.autoSave()">Bordures de toit métalliques</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="A-10" value="240" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="A-10" value="14" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="A-10">3 360,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td colspan="3">Sous-total Section A</td>
                        <td class="amount-display" data-subtotal="A">87 522,00 $</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Section B - Système d'enveloppe Premium -->
        <div class="section" data-section="B">
            <table class="table">
                <thead class="table-header">
                    <tr>
                        <th>Item</th>
                        <th>Quantité</th>
                        <th>Coût unitaire</th>
                        <th>Coût total</th>
                        <th title="Afficher/Masquer les items">☑</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header-row">
                        <td colspan="5"><input type="text" class="category-title-input" id="category-B" value="B - SYSTÈME D'ENVELOPPE PREMIUM" placeholder="Titre de la catégorie" onchange="APP.updateRecapLabels(); APP.autoSave()"></td>
                    </tr>
                    <tr class="section-row" data-item="B-1">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="B-1" value="Membrane haute performance" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="B-1" placeholder="Description détaillée" onchange="APP.autoSave()">Membrane pare-intempéries premium pour système métallique</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="B-1" value="15" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="B-1" value="220" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="B-1">3 300,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="B-2">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="B-2" value="Pare-vapeur intelligent" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="B-2" placeholder="Description détaillée" onchange="APP.autoSave()">Membrane pare-vapeur adaptative</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="B-2" value="10" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="B-2" value="180" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="B-2">1 800,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="B-3">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="B-3" value="Structure Z-Bar galvanisée" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="B-3" placeholder="Description détaillée" onchange="APP.autoSave()">Système de support métallique pour revêtement</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="B-3" value="400" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="B-3" value="18" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="B-3">7 200,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="B-4">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="B-4" value="Isolant laine minérale 3 pouces" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="B-4" placeholder="Description détaillée" onchange="APP.autoSave()">Isolation thermique et acoustique haute densité</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="B-4" value="50" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="B-4" value="85" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="B-4">4 250,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td colspan="3">Sous-total Section B</td>
                        <td class="amount-display" data-subtotal="B">16 550,00 $</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Section C - Quincaillerie spécialisée -->
        <div class="section" data-section="C">
            <table class="table">
                <thead class="table-header">
                    <tr>
                        <th>Item</th>
                        <th>Quantité</th>
                        <th>Coût unitaire</th>
                        <th>Coût total</th>
                        <th title="Afficher/Masquer les items">☑</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header-row">
                        <td colspan="5"><input type="text" class="category-title-input" id="category-C" value="C - QUINCAILLERIE SPÉCIALISÉE" placeholder="Titre de la catégorie" onchange="APP.updateRecapLabels(); APP.autoSave()"></td>
                    </tr>
                    <tr class="section-row" data-item="C-1">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="C-1" value="Vis auto-perceuses colorées" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="C-1" placeholder="Description détaillée" onchange="APP.autoSave()">Vis spécialisées avec tête colorée assortie</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="C-1" value="15" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="C-1" value="40" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="C-1">600,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="C-2">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="C-2" value="Attaches cachées MS1" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="C-2" placeholder="Description détaillée" onchange="APP.autoSave()">Système de fixation invisible</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="C-2" value="500" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="C-2" value="1.50" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="C-2">750,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="C-3">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="C-3" value="Rivets structuraux" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="C-3" placeholder="Description détaillée" onchange="APP.autoSave()">Rivets haute résistance pour assemblages critiques</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="C-3" value="10" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="C-3" value="45" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="C-3">450,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="C-4">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="C-4" value="Scellant architectural" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="C-4" placeholder="Description détaillée" onchange="APP.autoSave()">Scellant élastomère haute performance</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="C-4" value="30" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="C-4" value="22" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="C-4">660,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td colspan="3">Sous-total Section C</td>
                        <td class="amount-display" data-subtotal="C">2 460,00 $</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Section D - Main-d'œuvre spécialisée -->
        <div class="section" data-section="D">
            <table class="table">
                <thead class="table-header">
                    <tr>
                        <th>Item</th>
                        <th>Heures</th>
                        <th>Taux horaire</th>
                        <th>Coût total</th>
                        <th title="Afficher/Masquer les items">☑</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header-row">
                        <td colspan="5"><input type="text" class="category-title-input" id="category-D" value="D - MAIN-D'ŒUVRE SPÉCIALISÉE" placeholder="Titre de la catégorie" onchange="APP.updateRecapLabels(); APP.autoSave()"></td>
                    </tr>
                    <tr class="section-row" data-item="D-1">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="D-1" value="Installation système MS1" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="D-1" placeholder="Description détaillée" onchange="APP.autoSave()">Installation complète par équipe spécialisée en métal</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="D-1" value="480" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="D-1" value="85" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="D-1">40 800,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="section-row" data-item="D-2">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="D-2" value="Travail de précision métal" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="D-2" placeholder="Description détaillée" onchange="APP.autoSave()">Travaux de pliage, coupe et ajustements sur mesure</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="D-2" value="120" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="D-2" value="85" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="D-2">10 200,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td colspan="3">Sous-total Section D</td>
                        <td class="amount-display" data-subtotal="D">51 000,00 $</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Section E - Équipement spécialisé -->
        <div class="section" data-section="E">
            <table class="table">
                <thead class="table-header">
                    <tr>
                        <th>Item</th>
                        <th>Durée</th>
                        <th>Prix/sem.</th>
                        <th>Coût total</th>
                        <th title="Afficher/Masquer les items">☑</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header-row">
                        <td colspan="5"><input type="text" class="category-title-input" id="category-E" value="E - ÉQUIPEMENT SPÉCIALISÉ" placeholder="Titre de la catégorie" onchange="APP.updateRecapLabels(); APP.autoSave()"></td>
                    </tr>
                    <tr class="section-row" data-item="E-1">
                        <td class="item-description">
                            <input type="text" class="item-title-input" data-row="E-1" value="Équipement coupe et pliage" placeholder="Titre de l'item" onchange="APP.autoSave()">
                            <textarea class="item-details-input" data-row="E-1" placeholder="Description détaillée" onchange="APP.autoSave()">Plieuse portative, cisaille, outillage spécialisé métal, échafaudages</textarea>
                        </td>
                        <td><input type="number" class="quantity-input" data-row="E-1" value="4" min="0" max="99999" step="1" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td><input type="number" class="amount-input" data-row="E-1" value="2500" min="0" max="99999999" step="0.01" onchange="APP.calculateRowWithQuantity(this)"></td>
                        <td class="amount-display" data-total="E-1">10 000,00 $</td>
                        <td><input type="checkbox" class="hide-checkbox" checked onchange="APP.toggleRow(this)"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td colspan="3">Sous-total Section E</td>
                        <td class="amount-display" data-subtotal="E">10 000,00 $</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Récapitulatif des coûts -->
        <div class="summary-box">
            <h4>📊 RÉCAPITULATIF DES COÛTS</h4>
            <table class="summary-table">
                <tbody>
                <tr>
                    <td class="label"><span id="recap-label-A">A - MATÉRIAUX - SYSTÈME MS1</span>:</td>
                    <td class="value" id="recap-A">87 522,00 $</td>
                </tr>
                <tr>
                    <td class="label"><span id="recap-label-B">B - SYSTÈME D'ENVELOPPE PREMIUM</span>:</td>
                    <td class="value" id="recap-B">16 550,00 $</td>
                </tr>
                <tr>
                    <td class="label"><span id="recap-label-C">C - QUINCAILLERIE SPÉCIALISÉE</span>:</td>
                    <td class="value" id="recap-C">2 460,00 $</td>
                </tr>
                <tr>
                    <td class="label"><span id="recap-label-D">D - MAIN-D'ŒUVRE SPÉCIALISÉE</span>:</td>
                    <td class="value" id="recap-D">51 000,00 $</td>
                </tr>
                <tr>
                    <td class="label"><span id="recap-label-E">E - ÉQUIPEMENT SPÉCIALISÉ</span>:</td>
                    <td class="value" id="recap-E">10 000,00 $</td>
                </tr>
                <tr style="border-top: 1px solid #ddd; font-weight: bold;">
                    <td class="label">TOTAL DES TRAVAUX DE BASE:</td>
                    <td class="value" id="totalBase">167 532,00 $</td>
                </tr>
                <tr>
                    <td class="label">Administration (<span id="adminPercent">0</span>%):</td>
                    <td class="value" id="totalAdmin">0,00 $</td>
                </tr>
                <tr>
                    <td class="label">Contingences (<span id="contingencyPercent">0</span>%):</td>
                    <td class="value" id="totalContingency">0,00 $</td>
                </tr>
                <tr>
                    <td class="label">Profit de l'entrepreneur (<span id="profitPercent">15</span>%):</td>
                    <td class="value" id="totalProfit">25 129,80 $</td>
                </tr>
                <tr style="border-top: 1px solid var(--primary-color); font-weight: bold;">
                    <td class="label">Total avant taxes:</td>
                    <td class="value" id="totalAvantTaxes">192 661,80 $</td>
                </tr>
                <tr>
                    <td class="label">TPS (5%) - <span id="tpsDisplay">123456789RT0001</span>:</td>
                    <td class="value" id="totalTPS">9 633,09 $</td>
                </tr>
                <tr>
                    <td class="label">TVQ (9.975%) - <span id="tvqDisplay">1234567890TQ0001</span>:</td>
                    <td class="value" id="totalTVQ">19 218,01 $</td>
                </tr>
                <tr class="total-row">
                    <td class="label"><strong>INVESTISSEMENT TOTAL:</strong></td>
                    <td class="value"><strong id="totalFinal">221 512,90 $</strong></td>
                </tr>
                <tr style="border-top: 1px solid #ddd; margin-top: 10px;">
                    <td class="label" style="padding-top: 10px;"><strong>PRIX AU PI²:</strong></td>
                    <td class="value" style="padding-top: 10px;"><strong>57,63 $/pi²</strong></td>
                </tr>
            </tbody></table>
        </div>

        <!-- Tableau comparatif -->
        <h4 style="margin-top: 30px; margin-bottom: 15px; font-size: 13px; color: var(--primary-dark);">📊 TABLEAU COMPARATIF</h4>
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Critère</th>
                    <th>CANEXEL</th>
                    <th>MS1 ARCHITECTURAL</th>
                </tr>
            </thead>
            <tbody>
                <tr class="highlight">
                    <td>Prix total</td>
                    <td>170 870$</td>
                    <td>221 513$</td>
                </tr>
                <tr class="highlight">
                    <td>Prix au pi²</td>
                    <td>44,45$/pi²</td>
                    <td>57,63$/pi²</td>
                </tr>
                <tr>
                    <td>Durée travaux</td>
                    <td>4-5 semaines</td>
                    <td>4 semaines</td>
                </tr>
                <tr>
                    <td>Garantie produit</td>
                    <td>25 ans</td>
                    <td>40 ans</td>
                </tr>
                <tr>
                    <td>Entretien</td>
                    <td>Peinture aux 15 ans</td>
                    <td>Minimal</td>
                </tr>
                <tr>
                    <td>Résistance feu</td>
                    <td>Excellente</td>
                    <td>Supérieure</td>
                </tr>
                <tr>
                    <td>Résistance impacts</td>
                    <td>Bonne</td>
                    <td>Excellente</td>
                </tr>
                <tr>
                    <td>Valeur revente</td>
                    <td>+++</td>
                    <td>++++</td>
                </tr>
                <tr>
                    <td>Apparence</td>
                    <td>Bois naturel</td>
                    <td>Moderne architectural</td>
                </tr>
            </tbody>
        </table>

        <!-- Conditions et Exclusions -->
        <div class="conditions">
            <h4>GARANTIES MS1 ARCHITECTURAL</h4>
            <ul>
                <li><span class="condition-label">✓ Garantie manufacturier:</span> <textarea class="condition-input" id="condition-validite" onchange="APP.autoSave()">40 ans sur le produit MS1</textarea></li>
                <li><span class="condition-label">✓ Garantie peinture:</span> <textarea class="condition-input" id="condition-delai" onchange="APP.autoSave()">30 ans sur le fini de surface</textarea></li>
                <li><span class="condition-label">✓ Garantie installation:</span> <textarea class="condition-input" id="condition-paiement" onchange="APP.autoSave()">10 ans sur la main-d'œuvre et l'installation</textarea></li>
                <li><span class="condition-label">✓ Garantie perforation:</span> <textarea class="condition-input" id="condition-garanties" onchange="APP.autoSave()">À vie contre la perforation</textarea></li>
                <li><span class="condition-label">Validité de la soumission:</span> <textarea class="condition-input" id="condition-augmentation" onchange="APP.autoSave()">30 jours à partir de la date d'émission</textarea></li>
                <li><span class="condition-label">Délai d'exécution:</span> <textarea class="condition-input" id="condition-sol" onchange="APP.autoSave()">4 semaines, début 3 semaines après acceptation</textarea></li>
                <li><span class="condition-label">Modalités de paiement:</span> <textarea class="condition-input" id="condition-modifications" onchange="APP.autoSave()">30% à la signature, 40% mi-projet, 30% à la fin des travaux</textarea></li>
            </ul>
        </div>

        <div class="exclusions">
            <h4>CONDITIONS GÉNÉRALES</h4>
            <ul>
                <li><textarea class="exclusion-input" id="exclusion-1" onchange="APP.autoSave()">Permis de construction non inclus dans cette soumission</textarea></li>
                <li><textarea class="exclusion-input" id="exclusion-2" onchange="APP.autoSave()">Site doit être accessible et dégagé pour l'équipement</textarea></li>
                <li><textarea class="exclusion-input" id="exclusion-3" onchange="APP.autoSave()">Travaux garantis selon les normes RBQ en vigueur</textarea></li>
                <li><textarea class="exclusion-input" id="exclusion-4" onchange="APP.autoSave()">Choix de couleur parmi 35 couleurs standards MS1</textarea></li>
                <li><textarea class="exclusion-input" id="exclusion-5" onchange="APP.autoSave()">Retrait et disposition de l'ancien revêtement non inclus</textarea></li>
                <li><textarea class="exclusion-input" id="exclusion-6" onchange="APP.autoSave()">Réparations structurales si nécessaires en supplément</textarea></li>
                <li><textarea class="exclusion-input" id="exclusion-7" onchange="APP.autoSave()">Assurance responsabilité de 2M$ en vigueur</textarea></li>
                <li><textarea class="exclusion-input" id="exclusion-8" onchange="APP.autoSave()">Toute modification après signature fera l'objet d'un avenant écrit</textarea></li>
            </ul>
        </div>

        <!-- Section Pièces jointes -->
        <div class="attachments-section" id="attachmentsSection">
            <h4>📎 PIÈCES JOINTES</h4>
            
            <div class="attachment-dropzone" id="dropZone" onclick="document.getElementById('fileInput').click()">
                <div class="dropzone-icon">📁</div>
                <div class="dropzone-text">
                    Glissez-déposez vos fichiers ici ou cliquez pour parcourir
                </div>
                <label for="fileInput" class="file-input-label" onclick="event.stopPropagation()">
                    Choisir des fichiers
                </label>
                <input type="file" id="fileInput" multiple="" accept=".pdf,.docx,.doc,.xlsx,.xls,.csv,.txt,.rtf,.md,.jpg,.jpeg,.png,.gif,.bmp,.webp,.py,.js,.html,.htm,.css,.json,.xml,.yaml,.yml,.mp3,.wav,.m4a,.ogg,.flac,.aac" onchange="APP.handleFileSelect(event)">
                <div class="supported-formats">
                    Formats supportés: PDF, Word, Excel, Images, Audio, Code et plus...
                </div>
            </div>
            
            <div class="attachments-list" id="attachmentsList"><div style="text-align: center; color: #999; padding: 20px; font-size: 11px;">Aucun fichier joint</div></div>
        </div>

        <!-- Modal de prévisualisation -->
        <div class="file-preview-modal" id="filePreviewModal">
            <div class="preview-content" id="previewContent">
                <button class="preview-close" onclick="APP.closePreview()">×</button>
                <!-- Le contenu de la prévisualisation apparaîtra ici -->
            </div>
        </div>

        <!-- Section Signature Client -->
        <div class="signature-section" id="signatureSection">
            <h4>📝 DÉCISION DU CLIENT</h4>
            
            <div class="decision-buttons" id="decisionButtons">
                <button class="decision-btn btn-accept" onclick="APP.showSignatureForm('accept')">
                    ✅ ACCEPTER LA SOUMISSION
                </button>
                <button class="decision-btn btn-refuse" onclick="APP.showSignatureForm('refuse')">
                    ❌ REFUSER LA SOUMISSION
                </button>
            </div>

            <div class="signature-form" id="signatureForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="clientName">Nom complet *</label>
                        <input type="text" id="clientName" placeholder="Prénom et nom" required="">
                    </div>
                    <div class="form-group">
                        <label for="clientTitle">Titre/Fonction</label>
                        <input type="text" id="clientTitle" placeholder="Ex: Propriétaire, Gestionnaire">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="clientEmail">Courriel *</label>
                        <input type="email" id="clientEmail" placeholder="exemple@domaine.com" required="">
                    </div>
                    <div class="form-group">
                        <label for="clientPhone">Téléphone</label>
                        <input type="tel" id="clientPhone" placeholder="(514) 123-4567">
                    </div>
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label for="clientComments">Commentaires / Conditions</label>
                    <textarea id="clientComments" placeholder="Ajoutez vos commentaires, conditions ou demandes de modifications..."></textarea>
                </div>
                <div style="text-align: center;">
                    <button class="confirm-action-btn" id="confirmBtn" onclick="APP.confirmDecision()">
                        CONFIRMER MA DÉCISION
                    </button>
                </div>
            </div>

            <div class="confirmation-message" id="confirmationMessage">
                <div id="confirmationText"></div>
                <div class="signature-timestamp" id="signatureTimestamp"></div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p><strong>Soumission préparée par :</strong></p>
            <p style="margin-top: 10px;">
                <strong><input type="text" class="info-input inline" id="preparePar" placeholder="[Nom], [Titre]" style="width: 200px; text-align: center;" maxlength="100" onchange="APP.autoSave()"></strong><br>
                <input type="text" id="nomEntrepriseFooter" value="Groupe Perreault" style="border: none; background: transparent; text-align: center; width: 200px; font-weight: inherit;" placeholder="Nom de l'entreprise" maxlength="100" onchange="APP.autoSave()">
            </p>
            <p style="margin-top: 10px;">
                Pour information: 
                <input type="text" class="inline" id="telInfoFooter" value="450.123.4567" style="border: none; background: transparent; width: 100px;" placeholder="Téléphone" maxlength="20" onchange="APP.autoSave()">
            </p>
            <p style="margin-top: 12px; font-weight: bold;">
                <input type="text" id="messageConfiance" value="Merci de votre confiance!" style="border: none; background: transparent; text-align: center; width: 300px; font-weight: bold;" placeholder="Message de remerciement" maxlength="100" onchange="APP.autoSave()">
            </p>
            <p style="margin-top: 15px; font-size: 8px; color: #888; line-height: 1.3;">
                Cette soumission est confidentielle et demeure la propriété de <input type="text" class="inline" id="nomEntrepriseCopyright1" value="Groupe Perreault" style="border: none; background: transparent; font-size: 8px; color: #888; width: 120px;" placeholder="Nom entreprise" maxlength="100" onchange="APP.autoSave()">.
            </p>
            <p style="margin-top: 3px; font-size: 8px; color: #888;">
                © <input type="text" class="inline" id="anneeCopyright" value="2025" style="border: none; background: transparent; font-size: 8px; color: #888; width: 35px;" placeholder="Année" maxlength="4" onchange="APP.autoSave()"> <input type="text" class="inline" id="nomEntrepriseCopyright2" value="Groupe Perreault" style="border: none; background: transparent; font-size: 8px; color: #888; width: 120px;" placeholder="Nom entreprise" maxlength="100" onchange="APP.autoSave()"> - Tous droits réservés.
